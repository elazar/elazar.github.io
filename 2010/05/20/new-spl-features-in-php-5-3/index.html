<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>New SPL Features in PHP 5.3 - Matthew Turland</title>
        <meta name="description" content="The SPL, or Standard PHP Library, is an often overlooked extension in the PHP core.">
        <meta name="theme-color" content="00908F">
        <link rel="stylesheet" href="/css/tailwind.css?id=d85c79343964b7387a99">
                <link rel="alternate" type="application/atom+xml" href="/feed.xml" title="Matthew Turland">
        
        <script src="/js/site.js?id=21ace46f226931347224"></script>
    </head>
    <body class="bg-white font-sans leading-normal text-grey-800 px-4 sm:px-10" x-data="{ showMobileNav: false }">
        <nav class="flex flex-row-reverse lg:flex-row items-center justify-between lg:justify-start flex-wrap py-10 max-w-5xl mx-auto">
    <div class="text-md antialiased font-medium">
        <a href="/" class="block text-xl lg:inline-block lg:mr-12 font-black">Matthew Turland</a>
    </div>
    <div class="block lg:hidden">
        <button class="flex items-center px-1 text-gray-800" x-bind:class="{'hidden': showMobileNav}" @click="showMobileNav = true">
            <svg class="fill-current h-5 w-5" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <title>Open Menu</title>
                <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" />
            </svg>
        </button>
        <button class="items-center px-1 text-gray-800" x-bind:class="{'flex': showMobileNav, 'hidden': ! showMobileNav}" @click="showMobileNav = false" x-cloak>
            <svg class="fill-current h-5 w-5" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <title>Close Menu</title>
                <path
                    d="M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z" />
            </svg>
        </button>
    </div>
    <div class="w-full lg:w-auto lg:flex lg:clear items-center" @click.away="showMobileNav = false" x-bind:class="{ 'hidden': ! showMobileNav }">
                <a href="/archive" class="block  mt-4 lg:inline-block text-gray-600 hover:text-gray-800 lg:mt-0 mr-4">
            Blog
        </a>
                <a href="/about" class="block  mt-4 lg:inline-block text-gray-600 hover:text-gray-800 lg:mt-0 mr-4">
            About Me
        </a>
                <a href="/contact" class="block  mt-4 lg:inline-block text-gray-600 hover:text-gray-800 lg:mt-0 mr-4">
            Contact Me
        </a>
                <a href="/code" class="block  mt-4 lg:inline-block text-gray-600 hover:text-gray-800 lg:mt-0 mr-4">
            Portfolio
        </a>
                <a href="/publications" class="block  mt-4 lg:inline-block text-gray-600 hover:text-gray-800 lg:mt-0 mr-4">
            Publications
        </a>
                <a href="/presentations" class="block  mt-4 lg:inline-block text-gray-600 hover:text-gray-800 lg:mt-0 mr-4">
            Presentations
        </a>
        
    </div>
    <div class="flex flex-grow justify-end mt-6 lg:mt-0">
                <a href="https://github.com/elazar" class="ml-6 lg:ml-4" aria-label="Github" rel="me">
            <svg class="fill-current h-6 w-8 hover:text-teal" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" viewBox="0 0 16 16" width="16" height="16">><g transform="matrix(0.6666666666666666,0,0,0.6666666666666666,0,0)"><path d="M12,0.28C5.373,0.278-0.002,5.649-0.004,12.276c-0.002,5.197,3.342,9.804,8.284,11.414h0.29 c0.551,0.034,1.026-0.385,1.06-0.936c0.003-0.041,0.003-0.083,0-0.124v-0.21c0-0.17,0-0.4,0-1.09c-0.02-0.132-0.092-0.251-0.2-0.33 c-0.118-0.095-0.272-0.132-0.42-0.1c-2.68,0.58-3.25-1.1-3.29-1.21C5.384,18.801,4.784,18.037,4,17.5 c-0.047-0.041-0.097-0.077-0.15-0.11c0.116-0.063,0.249-0.087,0.38-0.07c0.511,0.071,0.948,0.405,1.15,0.88 c0.804,1.4,2.572,1.913,4,1.16c0.15-0.065,0.258-0.2,0.29-0.36c0.038-0.463,0.236-0.897,0.56-1.23 c0.206-0.183,0.225-0.499,0.042-0.706c-0.081-0.091-0.191-0.149-0.312-0.164c-2.37-0.27-4.79-1.1-4.79-5.19 c-0.02-1.027,0.356-2.023,1.05-2.78C6.351,8.786,6.386,8.579,6.31,8.4C6.032,7.624,6.036,6.774,6.32,6 c0.924,0.164,1.791,0.559,2.52,1.15c0.122,0.086,0.277,0.112,0.42,0.07c0.893-0.242,1.814-0.367,2.74-0.37 c0.929,0.001,1.854,0.125,2.75,0.37c0.14,0.039,0.291,0.013,0.41-0.07c0.73-0.589,1.597-0.984,2.52-1.15 c0.272,0.77,0.272,1.61,0,2.38c-0.076,0.179-0.041,0.386,0.09,0.53c0.687,0.75,1.062,1.733,1.05,2.75c0,4.09-2.43,4.91-4.81,5.18 c-0.275,0.029-0.474,0.274-0.446,0.549c0.013,0.129,0.076,0.248,0.176,0.331c0.448,0.463,0.671,1.099,0.61,1.74v3.18 c-0.01,0.317,0.122,0.621,0.36,0.83c0.303,0.227,0.696,0.298,1.06,0.19c6.285-2.103,9.676-8.902,7.573-15.187 C21.71,3.592,17.147,0.296,12,0.28z" stroke="none" fill="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>
        </a>
                <a href="https://phpc.social/@elazar" class="ml-6 lg:ml-4" aria-label="Mastodon" rel="me">
            <?xml version="1.0" standalone="no"?> <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" > <svg class="fill-current h-6 w-8 hover:text-teal" width="1034px" height="1034px" viewBox="-10 -5 1034 1034" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"> <path fill="currentColor" d="M499 112q-93 1 -166 11q-81 11 -128 33l-14 8q-16 10 -32 25q-22 21 -38 47q-21 33 -32 73q-14 47 -14 103v37q0 77 1 119q3 113 18 188q19 95 62 154q50 67 134 89q109 29 210 24q46 -3 88 -12q30 -7 55 -17l19 -8l-4 -75l-22 6q-28 6 -57 10q-41 6 -78 4q-53 -1 -80 -7 q-43 -8 -67 -30q-29 -25 -35 -72q-2 -14 -2 -29l25 6q31 6 65 10q48 7 93 9q42 2 92 -2q32 -2 88 -9t107 -30q49 -23 81.5 -54.5t38.5 -63.5q9 -45 13 -109q4 -46 5 -97v-41q0 -56 -14 -103q-11 -40 -32 -73q-16 -26 -38 -47q-15 -15 -32 -25q-12 -8 -14 -8 q-46 -22 -127 -33q-74 -10 -166 -11h-3zM367 267q73 0 109 56l24 39l24 -39q36 -56 109 -56q63 0 101 43t38 117v239h-95v-232q0 -74 -61 -74q-69 0 -69 88v127h-94v-127q0 -88 -69 -88q-61 0 -61 74v232h-95v-239q0 -74 38 -117t101 -43z" /> </svg>
        </a>
                <a href="https://ko-fi.com/elazar" class="ml-6 lg:ml-4" aria-label="Ko-Fi" rel="me">
            <svg class="fill-current h-6 w-8 hover:text-teal" aria-labelledby="simpleicons-ko-fi-icon" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title id="simpleicons-ko-fi-icon">Ko-fi icon</title><path d="M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604 0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407 0 0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"/></svg>
        </a>
                <a href="/feed.xml" class="ml-6 lg:ml-4" aria-label="Feed" rel="me">
            <?xml version="1.0" encoding="iso-8859-1"?> <!-- Generator: Adobe Illustrator 19.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0) --> <svg class="fill-current h-6 w-8 hover:text-teal" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 448 448" style="enable-background:new 0 0 448 448;" xml:space="preserve"> <g> <g> <circle cx="64" cy="384" r="64"/> </g> </g> <g> <g> <path d="M0,149.344v85.344c117.632,0,213.344,95.68,213.344,213.312h85.312C298.656,283.328,164.672,149.344,0,149.344z"/> </g> </g> <g> <g> <path d="M0,0v85.344C200,85.344,362.688,248,362.688,448H448C448,200.96,247.04,0,0,0z"/> </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> </svg>
        </a>
                <a href="mailto:me@matthewturland.com" class="ml-6 lg:ml-4" aria-label="Email" rel="me">
            <svg class="fill-current h-6 w-8 hover:text-teal" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" viewBox="0 0 16 16" width="16" height="16">><g transform="matrix(0.6666666666666666,0,0,0.6666666666666666,0,0)"><path d="M 2.25,4.5h19.5c0.828,0,1.5,0.672,1.5,1.5v12c0,0.828-0.672,1.5-1.5,1.5H2.25c-0.828,0-1.5-0.672-1.5-1.5V6 C0.75,5.172,1.422,4.5,2.25,4.5z " stroke="currentColor" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 15.687,9.975L19.5,13.5 " stroke="currentColor" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 8.313,9.975L4.5,13.5 " stroke="currentColor" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 22.88,5.014l-9.513,6.56 c-0.823,0.568-1.911,0.568-2.734,0L1.12,5.014" stroke="currentColor" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>
        </a>
        
    </div>
</nav>

        <div class="max-w-5xl mx-auto relative content">
    <article class="max-w-2xl mx-auto">
        <h1>New SPL Features in PHP 5.3</h1>
        <div class="bg-gray-800 inline-block text-sm mb-16 pr-4 pl-16 -ml-16 uppercase tracking-widest text-white py-1 rounded-r-full">
            Published
                            in <a href="/archive/tags/php" class="text-teal-light no-underline hover:text-white">PHP</a>
                        on May 20, 2010
        </div>
        <div class="content">
            <p><em>Note: I've <a href="https://web.archive.org/web/20130805120049/http://blueparabola.com/blog/spl-deserves-some-reiteration" title="The SPL Deserves Some Reiteration | Blue Parabola, LLC">written on this topic before</a>, but thought the subject warranted further more detailed discussion and a more comprehensive and up-to-date set of benchmarks. Hence, this post and <a href="http://www.slideshare.net/tobias382/new-spl-features-in-php-53" title="New SPL Features in PHP 5.3">this presentation</a>.&nbsp;Enjoy.</em></p>
<p>The <a href="http://php.net/spl" title="PHP: SPL - Manual">SPL</a>, or Standard PHP Library, is an often overlooked extension in the PHP core. It first came on the scene in PHP 5 and a variety of <a href="http://php.net/manual/en/spl.iterators.php" title="PHP: Iterators - Manual">iterators</a> constituted the majority of its initial offerings. Though the <a href="http://www.php.net/manual/en/migration53.classes.php" title="PHP: New Classes - Manual">iterator offerings were expanded in PHP 5.3</a>, the particularly interesting additions to the SPL were several specialized <a href="http://en.wikipedia.org/wiki/Data_structures" title="Data structure - Wikipedia, the free encyclopedia">data structure</a> <a href="http://php.net/manual/en/spl.datastructures.php" title="PHP: Datastructures - Manual">classes</a>, the foundational concepts for which originate in the field of <a href="http://en.wikipedia.org/wiki/Computer_science" title="Computer science - Wikipedia, the free encyclopedia">computer science</a>. In this post, I will provide an overview of these new classes and explain why and when they should be&nbsp;used.</p>
<h3>Arrays</h3>
<p>While PHP has several data types, the ones that likely see the most frequent and varied use are <a href="http://php.net/manual/en/language.types.string.php" title="PHP: Strings - Manual">strings</a> and <a href="http://php.net/manual/en/language.types.array.php" title="PHP: Arrays - Manual">arrays</a>. They are the proverbial <a href="http://en.wikipedia.org/wiki/Duct_tape#Common_uses" title="Duct tape - Wikipedia, the free encyclopedia">duct tape</a> and <a href="http://en.wikipedia.org/wiki/WD-40#Function" title="WD-40 - Wikipedia, the free encyclopedia">WD-40</a> of PHP, respectively. Like arrays, SPL data structure classes are used to store composite (i.e. non-<a href="http://en.wikipedia.org/wiki/Scalar_(computing)" title="Scalar (computing) - Wikipedia, the free encyclopedia">scalar</a>)&nbsp;data.</p>
<p>Now, that's not to say that every instance of an array in existing codebases should be replaced with an SPL container object. There are cases where its appropriate to use one over the other. Knowing the difference requires an understanding of how arrays&nbsp;work.</p>
<p>Within the C code that makes up the PHP interpreter, arrays are implemented as a data structure called a <a href="http://en.wikipedia.org/wiki/Hash_table" title="Hash table - Wikipedia, the free encyclopedia">hash table or hash map</a>. When a value contained within an array is referenced by its index, PHP uses a <a href="https://git.php.net/?p=php-src.git;a=blob;f=Zend/zend_hash.h;hb=dd5c478be61a0ef94b54837cfa875c964356e14f#l228">hashing function</a> to convert that index into a unique hash representing the location of the corresponding value within the&nbsp;array.</p>
<p>This hash map implementation enables arrays to store an arbitrary number of elements and provide access to all of those elements simultaneously using either numeric or string keys. Arrays are extremely fast for the capabilities they provide and are an excellent general purpose data&nbsp;structure.</p>
<h3>Fixed&nbsp;Arrays</h3>
<p>In contrast to arrays, <a href="http://php.net/manual/en/class.splfixedarray.php" title="PHP: SplFixedArray - Manual"><code>SplFixedArray</code></a> functions more like <a href="http://www.cplusplus.com/doc/tutorial/arrays/" title="Arrays">C arrays</a> or <a href="http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html" title="Arrays (The Java™ Tutorials &gt; Learning the Java Language &gt; Language Basics)">Java arrays</a> than <a href="http://php.net/manual/en/language.types.array.php" title="PHP: Arrays - Manual">PHP arrays</a>. The maximum number of elements that it may contain is specified upon instantiation. While it is possible to change it later via the <code>setSize()</code> method, this negates the performance advantages of using it: because its size is fixed, it doesnt need to use a hashing function to resolve the position of elements within the array. <strong>It makes sense to use fixed arrays when the number of elements to be stored is known in advance and the elements only need to be accessed by sequential&nbsp;position.</strong></p>
<p><code>SplFixedArray</code> implements the <a href="http://php.net/manual/en/class.iterator.php" title="PHP: Iterator - Manual"><code>Iterator</code></a>, <a href="http://php.net/manual/en/class.arrayaccess.php" title="PHP: ArrayAccess - Manual"><code>ArrayAccess</code></a>, and <a href="http://php.net/manual/en/class.countable.php" title="PHP: Countable - Manual"><code>Countable</code></a> interfaces. <code>Iterator</code> allows it to be iterated using a <a href="http://php.net/manual/en/control-structures.foreach.php" title="PHP: foreach - Manual"><code>foreach</code></a> loop. <code>ArrayAccess</code> provides access to its elements using <a href="http://php.net/manual/en/language.types.array.php#language.types.array.syntax.modifying" title="PHP: Arrays - Manual">array syntax</a> where elements are referred to using integer positions beginning at 0 as with enumerated arrays. <code>Countable</code> enables a list to be passed to the <a href="http://php.net/count" title="PHP: count - Manual"><code>count()</code></a> function like an&nbsp;array.</p>
<p>Aside from the inability to use it in place of arrays with <a href="http://php.net/manual/en/ref.array.php" title="PHP: Array Functions - Manual">array functions</a>, instances of <code>SplFixedArray</code> function just like arrays for all intents and purposes. It's even possible to convert them to and from arrays using the <a href="http://php.net/manual/en/splfixedarray.toarray.php" title="PHP: SplFixedArray::toArray - Manual"><code>toArray()</code></a> and <a href="http://php.net/manual/en/splfixedarray.fromarray.php" title="PHP: SplFixedArray::fromArray - Manual"><code>fromArray()</code></a> methods respectively. However, it generally makes more sense to use <code>SplFixedArray</code> exclusively for each individual use&nbsp;case.</p>
<h3>Lists</h3>
<p>In <a href="http://en.wikipedia.org/wiki/Computer_science" title="Computer science - Wikipedia, the free encyclopedia">computer science</a>, a <a href="http://en.wikipedia.org/wiki/List_(computing)" title="List (computing) - Wikipedia, the free encyclopedia">list</a> is defined as an ordered collection of values. A <a href="http://en.wikipedia.org/wiki/Linked_list" title="Linked list - Wikipedia, the free encyclopedia">linked list</a> is a data structure in which each element in the list includes a reference to one or both of the elements on either side of it within the list. The term <a href="http://en.wikipedia.org/wiki/Doubly-linked_list" title="Doubly-linked list - Wikipedia, the free encyclopedia">doubly-linked list</a> is used to refer to the latter case. In the SPL, this takes the form of the class&nbsp;<a href="http://php.net/manual/en/class.spldoublylinkedlist.php" title="PHP: SplDoublyLinkedList - Manual"><code>SplDoublyLinkedList</code></a>.</p>
<p>Like <code>SplFixedArray</code>, <code>SplDoublyLinkedList</code> also implements the <a href="http://php.net/manual/en/class.iterator.php" title="PHP: Iterator - Manual"><code>Iterator</code></a>, <a href="http://php.net/manual/en/class.arrayaccess.php" title="PHP: ArrayAccess - Manual"><code>ArrayAccess</code></a>, and <a href="http://php.net/manual/en/class.countable.php" title="PHP: Countable - Manual"><code>Countable</code></a> interfaces. In addition to the methods that come with these interface implementations, elements can be added to or removed from the start or end of the list using its <a href="http://php.net/manual/en/spldoublylinkedlist.push.php" title="PHP: SplDoublyLinkedList::push - Manual"><code>push()</code></a>, <a href="http://php.net/manual/en/spldoublylinkedlist.pop.php" title="PHP: SplDoublyLinkedList::pop - Manual"><code>pop()</code></a>, <a href="http://php.net/manual/en/spldoublylinkedlist.shift.php" title="PHP: SplDoublyLinkedList::shift - Manual"><code>shift()</code></a> and <a href="http://php.net/manual/en/spldoublylinkedlist.unshift.php" title="PHP: SplDoublyLinkedList::unshift - Manual"><code>unshift()</code></a> methods, which correspond to the <a href="http://php.net/array_push" title="PHP: array_push - Manual"><code>array_push()</code></a>, <a href="http://php.net/array_pop" title="PHP: array_pop - Manual"><code>array_pop()</code></a>, <a href="http://php.net/array_shift" title="PHP: array_shift - Manual"><code>array_shift()</code></a>, and <a href="http://php.net/array_unshift" title="PHP: array_unshift - Manual"><code>array_unshift()</code></a> functions respectively. Unfortunately, as of PHP 5.3.4, theres no way to insert an element anywhere in the list other than at the beginning or the end. A <a href="https://bugs.php.net/bug.php?id=48358" title="PHP Bugs: #48358: SplDoublyLinkedList needs an insertAfterIterator() method or something similar">feature request</a> has been filed for this. Add a comment or vote to show support for its&nbsp;addition.</p>
<p>The elements at the start and end of the list are accessible via its <a href="http://php.net/manual/en/spldoublylinkedlist.top.php" title="PHP: SplDoublyLinkedList::top - Manual"><code>top()</code></a> and <a href="http://php.net/manual/en/spldoublylinkedlist.bottom.php" title="PHP: SplDoublyLinkedList::bottom - Manual"><code>bottom()</code></a> methods respectively, which correspond to the <a href="http://php.net/manual/en/function.reset.php" title="PHP: reset - Manual"><code>reset()</code></a> and <a href="http://php.net/manual/en/function.end.php" title="PHP: end - Manual"><code>end()</code></a> functions. Like <code>SplFixedArray</code>, elements can also be accessed arbitrarily by positional index using the array syntax granted by <code>ArrayAccess</code>. <strong>It makes sense to use lists when the number of elements to be stored is not known in advance and the elements only need to be accessed by sequential&nbsp;position.</strong></p>
<h3>Stacks</h3>
<p><a href="http://en.wikipedia.org/wiki/Stack_(data_structure)" title="Stack (data structure) - Wikipedia, the free encyclopedia">Stacks</a> are similar to lists with two major differences. First, elements can only be added to the top of the stack. Second, an element can only be accessed by taking it off the top of the stack. Because of these differences, the stack is often referred to as a Last-In-First-Out or <a href="http://en.wikipedia.org/wiki/LIFO_(computing)" title="LIFO (computing) - Wikipedia, the free encyclopedia">LIFO</a> data structure. <a href="http://php.net/manual/en/class.splstack.php" title="PHP: SplStack - Manual"><code>SplStack</code></a> is the SPL stack&nbsp;implementation.</p>
<p><code>SplStack</code> is a bit removed from the traditional definition of a stack. It extends <code>SplDoublyLinkedList</code> and inherits its abilities, some of which dont really apply to stacks. In order to enforce its restriction on how elements are accessed, <code>SplStack</code> overrides the <a href="http://php.net/manual/en/spldoublylinkedlist.setiteratormode.php" title="PHP: SplDoublyLinkedList::setIteratorMode - Manual"><code>setIteratorMode()</code></a> method of its parent class and implements <a href="http://php.net/manual/en/splstack.setiteratormode.php" title="PHP: SplStack::setIteratorMode - Manual">its own</a> to prevent modification of the iteration direction. Both methods allow elements to be retained or removed as they are&nbsp;iterated.</p>
<p><strong>Use of stacks makes sense when the number of elements to be stored is not known in advance and the only element that must be accessible is the last one stored.</strong> However, as of PHP 5.3.4, the performance of <code>SplStack</code> leaves something to be desired. Benchmarks included later in this provide an objective illustration of this, though the cause of the behavior remains&nbsp;unknown.</p>
<h3>Queues</h3>
<p><a href="http://en.wikipedia.org/wiki/Queue_(data_structure)" title="Queue (data structure) - Wikipedia, the free encyclopedia">Queues</a> are also similar to lists, again with two major differences. First, elements can only be added (or enqueued) to the end of the queue. Second, an element can only be accessed by removing (or dequeueing) it from the beginning of the queue. For these reasons the queue is referred to as a First-In-First-Out or <a href="http://en.wikipedia.org/wiki/FIFO" title="FIFO - Wikipedia, the free encyclopedia">FIFO</a> data structure. The <a href="http://php.net/manual/en/class.splqueue.php" title="PHP: SplQueue - Manual"><code>SplQueue</code></a> class implements this data structure in the&nbsp;SPL.</p>
<p><code>SplQueue</code> follows suit with <code>SplStack</code> in extending <code>SplDoublyLinkedList</code>. Just as <code>SplStack</code> resultingly inherits some operations with at least questionable applicability, so too does <code>SplQueue</code>. Likewise, it overrides <code>setIteratorMode()</code> with <a href="http://php.net/manual/en/splqueue.setiteratormode.php" title="PHP: SplQueue::setIteratorMode - Manual">its own version</a> to restrict how elements are accessed. <strong>Use of queues makes sense when the number of elements to be stored is not known in advance and the only element that must be accessible is the remaining element that was stored&nbsp;earliest.</strong></p>
<p>One minor difference between <code>SplQueue</code> and <code>SplStack</code> is that the former contains two method aliases named after conceptual queue operations: <a href="http://php.net/manual/en/splqueue.dequeue.php" title="PHP: SplQueue::dequeue - Manual"><code>dequeue()</code></a> aliases <a href="http://php.net/manual/en/spldoublylinkedlist.shift.php" title="PHP: SplDoublyLinkedList::shift - Manual"><code>SplDoublyLinkedList::shift()</code></a> and <a href="http://php.net/manual/en/splqueue.enqueue.php" title="PHP: SplQueue::enqueue - Manual"><code>enqueue()</code></a> aliases <a href="http://php.net/manual/en/spldoublylinkedlist.push.php" title="PHP: SplDoublyLinkedList::push - Manual"><code>SplDoublyLinkedList::push()</code></a>. This makes sense because while <code>push()</code> and <code>pop()</code> share similar applicability to conceptual stack operations, they are already present in its parent&nbsp;class.</p>
<p>Despite their common ancestry, <code>SplQueue</code> appears to have better performance than <code>SplStack</code> as of PHP 5.3.4. Benchmarks included later in this post review this in more&nbsp;detail.</p>
<h3>Heaps</h3>
<p>Up to this point, the data structures discussed have resembled lists insofar as they contain elements in the order in which they were added. By contrast, when an element is added to a <a href="http://en.wikipedia.org/wiki/Heap_(data_structure)" title="Heap (data structure) - Wikipedia, the free encyclopedia">heap</a>, a comparison function is used to compare the new element to other elements already in the heap and element is placed appropriately within the heap based on that functions return value. The beauty of heaps is that their underlying algorithm does this with minimal element comparisons, so it's extremely efficient. <strong>Using heaps makes sense when the number of elements to be stored is not known in advance and elements must be accessed in an order based on how they compare to each&nbsp;other.</strong></p>
<p><a href="http://php.net/manual/en/class.splheap.php" title="PHP: SplHeap - Manual"><code>SplHeap</code></a> is an abstract class used to create a heap by extending it and providing a comparison function in the form of its <a href="http://php.net/manual/en/splheap.compare.php" title="PHP: SplHeap::compare - Manual"><code>compare()</code></a> method. Only the root element of a heap, the one yielding the highest comparison function return value, may be accessed or removed from the heap at any given time. This is done using the <a href="http://php.net/manual/en/splheap.extract.php" title="PHP: SplHeap::extract - Manual"><code>extract()</code></a> method of <code>SplHeap</code>. <code>SplHeap</code> implements the <a href="http://php.net/manual/en/class.iterator.php" title="PHP: Iterator - Manual"><code>Iterator</code></a> and <a href="http://php.net/manual/en/class.countable.php" title="PHP: Countable - Manual"><code>Countable</code></a> interfaces but, because only the root element can be extracted, it does not implement the <a href="http://php.net/manual/en/class.arrayaccess.php" title="PHP: ArrayAccess - Manual"><code>ArrayAccess</code></a> interface like the previously discussed data structure&nbsp;classes.</p>
<p>In addition to the abstract <code>SplHeap</code> class, two concrete implementations are also included in the SPL, namely <a href="http://php.net/manual/en/class.splminheap.php" title="PHP: SplMinHeap - Manual"><code>SplMinHeap</code></a> and <a href="http://php.net/manual/en/class.splmaxheap.php" title="PHP: SplMaxHeap - Manual"><code>SplMaxHeap</code></a>. The <a href="http://php.net/manual/en/splminheap.compare.php" title="PHP: SplMinHeap::compare - Manual"><code>compare()</code></a> method of <code>SplMinHeap</code> returns a value such that the smallest element in the heap is the root element. Likewise, the <a href="http://php.net/manual/en/splmaxheap.compare.php" title="PHP: SplMaxHeap::compare - Manual"><code>compare()</code></a> method of <code>SplMaxHeap</code> returns a value such that the largest element in the heap is the root&nbsp;element.</p>
<p>At first glance, using a subclass of <code>SplHeap</code> may seem equivalent to calling <a href="http://php.net/sort" title="PHP: sort - Manual"><code>sort()</code></a> or a similar function on an array and accessing the elements in sequence. This is indeed the case if all elements are added to the array prior to it being sorted. However, situations such as elements arriving over time or inadequate memory to store all elements simultaneously may preclude this approach. Use of arrays in such situations would require repeated resorting of the entire array as new elements are added, which is inefficient. This is why using the corresponding heap class makes a lot more sense in that situation than repeated calls to <a href="http://php.net/sort" title="PHP: sort - Manual"><code>sort()</code></a>, <a href="http://php.net/manual/en/function.min.php" title="PHP: min - Manual"><code>min()</code></a>, or <a href="http://php.net/manual/en/function.max.php" title="PHP: max - Manual"><code>max()</code></a>. Additionally, <code>SplHeap</code> can be used to implement the <a href="http://en.wikipedia.org/wiki/Heapsort" title="Heapsort - Wikipedia, the free encyclopedia">heapsort algorithm</a>, which has <a href="http://en.wikipedia.org/wiki/Heapsort#Comparison_with_other_sorts" title="Heapsort - Wikipedia, the free encyclopedia">better worst case performance</a> than the <a href="http://en.wikipedia.org/wiki/Quicksort" title="Quicksort - Wikipedia, the free encyclopedia">quicksort algorithm</a> <a href="https://git.php.net/?p=php-src.git;a=blob;f=Zend/zend_qsort.c;hb=1515fda4f3236d4777edcf5f71c0096dc79024b4#l56">implementation</a> <a href="https://git.php.net/?p=php-src.git;a=blob;f=ext/standard/array.c;hb=1515fda4f3236d4777edcf5f71c0096dc79024b4#l541">used by&nbsp;arrays</a>.</p>
<h3>Priority&nbsp;Queues</h3>
<p><a href="http://en.wikipedia.org/wiki/Priority_queue" title="Priority queue - Wikipedia, the free encyclopedia">Priority queues</a> are somewhat similar to heaps. In fact, while it doesn't extend <code>SplHeap</code>, <a href="http://php.net/manual/en/class.splpriorityqueue.php" title="PHP: SplPriorityQueue - Manual"><code>SplPriorityQueue</code></a> does make use of a heap structure internally to implement its functionality. The difference is that the <a href="http://www.php.net/manual/en/splpriorityqueue.insert.php" title="PHP: SplPriorityQueue::insert - Manual"><code>insert()</code></a> method of <code>SplPriorityQueue</code> queue accepts both a value and an associated priority, removing the need to use an array or object to store both of these and define an appropriate comparison function in an <code>SplHeap</code> instance. Elements with the highest priority, like those in <code>SplMaxHeap</code> with the highest value, are the ones that come out first when <a href="http://php.net/manual/en/splpriorityqueue.extract.php" title="PHP: SplPriorityQueue::extract - Manual"><code>extract()</code></a> is called. Note that elements with equal priority are returned in no particular&nbsp;order.</p>
<p>For reasons similar to those of <code>SplHeap</code>, <code>SplPriorityQueue</code> implements both <a href="http://php.net/manual/en/class.iterator.php" title="PHP: Iterator - Manual"><code>Iterator</code></a> and <a href="http://php.net/manual/en/class.countable.php" title="PHP: Countable - Manual"><code>Countable</code></a> interfaces and does not implement the <a href="http://php.net/manual/en/class.arrayaccess.php" title="PHP: ArrayAccess - Manual"><code>ArrayAccess</code></a> interface. Because it stores a value and priority per element, <code>SplPriorityQueue</code> includes a <a href="http://php.net/manual/en/splpriorityqueue.setextractflags.php" title="PHP: SplPriorityQueue::setExtractFlags - Manual"><code>setExtractFlags()</code></a> method that modifies the behavior of <code>extract()</code> to return the stored value, the stored priority, or an array containing both. Priorities are not bound to a particular data type: strings, integers, or even composite data types can be used. <code>SplPriorityQueue</code> can be extended and its <a href="http://www.php.net/manual/en/splpriorityqueue.compare.php" title="PHP: SplPriorityQueue::compare - Manual"><code>compare()</code></a> method overridden to customize the comparison&nbsp;logic.</p>
<p><strong>It makes sense to use a priority queue when the number of elements to be stored is not known in advance and elements must be accessed in an order based on how a value associated with each element (versus the element value itself) compares to the same associated values of other&nbsp;elements.</strong></p>
<h3>Sets and Composite Hash&nbsp;Maps</h3>
<p><a href="http://php.net/manual/en/class.splobjectstorage.php" title="PHP: SplObjectStorage - Manual"><code>SplObjectStorage</code></a> combines some of the properties of two different data structures. First, it provides the same functionality of a <a href="http://en.wikipedia.org/wiki/Hash_table" title="Hash table - Wikipedia, the free encyclopedia">hash table</a> that a normal array has, but without its associated inability to use objects as keys unless the <a href="http://php.net/spl_object_hash" title="PHP: spl_object_hash - Manual"><code>spl_object_hash()</code></a> function is used. In other words, it implements a composite hash map. Second, it can be used as a <a href="http://en.wikipedia.org/wiki/Set_(computer_science)" title="Set (computer science) - Wikipedia, the free encyclopedia">set</a> to store objects as data without a meaningful corresponding key or concept of sequential&nbsp;order.</p>
<p>Its <a href="http://php.net/manual/en/splobjectstorage.attach.php" title="PHP: SplObjectStorage::attach - Manual"><code>attach()</code></a> method accepts an object key and the data to associate with it and its <a href="http://php.net/manual/en/splobjectstorage.detach.php" title="PHP: SplObjectStorage::detach - Manual"><code>detach()</code></a> method allows data to be removed using its associated object key. To use the object as a set, simply exclude the <code>$data</code> parameter for <code>attach()</code>, as it's optional. The <a href="http://en.wikipedia.org/wiki/Set_(computer_science)#Operations" title="Set (computer science) - Wikipedia, the free encyclopedia">set operations</a> implemented by <code>SplObjectStorage</code> all have array function counterparts. For example, the <a href="http://php.net/manual/en/splobjectstorage.addall.php" title="PHP: SplObjectStorage::addAll - Manual"><code>addAll()</code></a> method and <a href="http://php.net/manual/en/function.array-merge.php" title="PHP: array_merge - Manual"><code>array_merge()</code></a> function both correspond to the union set operation. The difference operation is available using the <a href="http://php.net/manual/en/splobjectstorage.removeall.php" title="PHP: SplObjectStorage::removeAll - Manual"><code>removeAll()</code></a> method and <a href="http://php.net/manual/en/function.array-diff.php" title="PHP: array_diff - Manual"><code>array_diff()</code></a> function and its variants. The <a href="http://php.net/manual/en/splobjectstorage.contains.php" title="PHP: SplObjectStorage::contains - Manual"><code>contains()</code></a> method and <a href="http://php.net/manual/en/function.in-array.php" title="PHP: in_array - Manual"><code>in_array()</code></a> function both implement the <code>element_of</code> operation. Sadly, only arrays have an implementation of the intersection operation in the form of <a href="http://php.net/manual/en/function.array-intersect.php" title="PHP: array_intersect - Manual"><code>array_intersect()</code></a> and its variants. Tobias Schlitt has a <a href="http://schlitt.info/opensource/blog/0722_python_good_bad_evil_02_native_sets.html" title="Python. Good, bad, evil -2-: Native sets - Blog - Open Source - schlitt.info">more in-depth analysis</a> of this data structure that includes implementations of the set operations lacking in the SPL&nbsp;itself.</p>
<p><strong>Update: A patch I've submitted has been <a href="http://news.php.net/php.cvs/64274" title="php.cvs: svn:_/php/php-src/_branches/PHP_5_3/ext/spl/spl_observer.c_branches/PHP_5_3/ext/spl/tests/SplObjectStorage_removeAllExcept_basic.phpt_branches/PHP_5_3/ext/spl/tests/SplObjectStorage_removeAllExcept_invalid_parameter.phpt_trunk/ext/spl/spl_observer.c_trunk/ext/spl/tests/SplObjectStorage_removeAllExcept_basic.phpt_trunk/ext/spl/tests/SplObjectStorage_removeAllExcept_invalid_parameter.phpt">merged</a>. <a href="http://php.net/manual/en/splobjectstorage.removeallexcept.php" title="PHP: SplObjectStorage::removeAllExcept - Manual">SplObjectStorage::removeAllExcept()</a>, which is equivalent to the set intersection operation, will become available in PHP 5.3.5.&nbsp;(1/5/2011)</strong></p>
<p>Like some of the other data structures in the SPL, <code>SplObjectStorage</code> implements the <a href="http://php.net/manual/en/class.iterator.php" title="PHP: Iterator - Manual"><code>Iterator</code></a>, <a href="http://php.net/manual/en/class.countable.php" title="PHP: Countable - Manual"><code>Countable</code></a>, and <a href="http://php.net/manual/en/class.arrayaccess.php" title="PHP: ArrayAccess - Manual"><code>ArrayAccess</code></a> interfaces. Oddly, it also implements the <a href="http://php.net/manual/en/class.traversable.php" title="PHP: Traversable - Manual"><code>Traversable</code></a> interface (which is limited to internally defined classes and negates the need for implementation of the <code>Iterator</code> interface) and the <a href="http://php.net/manual/en/class.serializable.php" title="PHP: Serializable - Manual"><code>Serializable</code></a> interface (and it is the only SPL data structure class to do&nbsp;so).</p>
<p><strong>Using this class makes sense when data must be stored using composite keys or the ability to access data using set operations is more important than accessing data in a specific&nbsp;order.</strong></p>
<h3>Benchmarks</h3>
<p><em>Standard disclaimer: There are <a href="http://en.wikipedia.org/wiki/Lies,_damned_lies,_and_statistics" title="Lies, damned lies, and statistics - Wikipedia, the free encyclopedia">lies, damned lies, and benchmarks</a>.&nbsp;<a href="http://en.wiktionary.org/wiki/your_mileage_may_vary" title="your mileage may vary - Wiktionary"><acronym title="Your Mileage May Vary">YMMV</acronym></a>.</em></p>
<p>Code and instructions are located in <a href="https://github.com/elazar/spl-benchmarks" title="elazar's spl-benchmarks at master - GitHub">this GitHub&nbsp;repository</a>.</p>
<p><strong>Update: I've removed benchmark result charts generated on my system from this post. I encourage you to run the benchmarks yourself to get your own results.&nbsp;(4/14/2015)</strong></p>
<h3>Other Data&nbsp;Structures</h3>
<p>If you have an interest in other data structure implementations for PHP outside of SPL offerings, check out the <a href="http://pecl.php.net/package/bloomy" title="PECL :: Package :: bloomy">bloomy</a> <a href="http://pecl.php.net/" title="PECL :: The PHP Extension Community Library">PECL</a> extension, which is an implementation of a <a href="http://en.wikipedia.org/wiki/Bloom_filter" title="Bloom filter - Wikipedia, the free encyclopedia">bloom filter</a> created by <a href="http://zmievski.org/2009/04/bloom-filters-quickie" title="Bloom Filters Quickie - Andrei Zmievski">Andrei&nbsp;Zmievski</a>.</p>

        </div>
    </article>
</div>

        <nav class="text-center py-12 mx-auto">
    <div class="text-sm">&copy; 2007-2024 Matthew Turland.</div>
</nav>

    </body>
</html>
